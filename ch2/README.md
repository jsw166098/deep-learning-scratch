# 2.퍼셉트론

퍼셉트론 알고리즘은 신경망(딥러닝)의 기원이 되는 알고리즘이다.

## 2.1 퍼셉트론이란?

퍼셉트론은 다수의 신호를 입력받아 하나의 신호를 출력한다.
신호는 흐름과 비슷하다.

### 퍼셉트론의 신호 

* 퍼셉트론의 신호는 전류 또는 강물 처럼 흐름으로 생각될 수 있다.
* 전류는 전선을 타고 흐르는 전자를 내보낸다 == 퍼셉트론 신호는 흐름을 만들고 정보를 앞으로 전달한다.
* 퍼셉트론의 신호는 흐른다(1), 흐르지 않는다.(0) 두가지 값을 가질 수 있다.

|신호|전류|
|--|--|
|정보|전자|
|가중치|저항|

### 입력이 2개인 퍼셉트론


![dlsimg_21](https://github.com/jsw166098/deep-learning-scratch/blob/main/img/dlsimg_21.png)

* x1, x2 -> 입력 신호
* y -> 출력 신호
* w1, w2 -> 가중치
* 원 -> 노드, 뉴런
* 입력 신호가 뉴런에 보내질 때 각각의 고유한 가중치가 곱해진다.
* 정해진 가중치의 한계 지점을 넘을 때 1을 출력한다. -> 뉴런이 활성화한다.
* 가중치의 한계 지점, 뉴런이 활성화되는 지점, 1을 출력하는 지점 -> 한계값, 세타
* 퍼셉트론은 각각의 신호에 고유한 가중치가 부여되며 가중치가 클수록 해당 신호가 그만큼 더 중요함을 뜻한다.
* 퍼셉트론의 가중치와 실제 저항의 작용 방향은 반대이다. -> 가중치가 클 수록 강한 신호를 흘러보냄 반면 저항이 클 수록 약한 전류를 흘려보낸다.

~~~
y={
 0 (w1x1 + w2x2 <= 세타)
 1 (w1x1 + w2x2 > 세타)
}
~~~

결국 정해진 입력값, 출력값을 토대로 가중치와 세타를 구하는 것이다.

## 2.2 단순한 논리 회로

* 전자 회로 $ 전기 회로 -> 전기가 흐를 수 있는 물리적 장치 회로
* 논리 회로 -> 2 이상의 입력값에 대해 하나의 출력값을 얻는 물리적 전기 장치 회로

~~~
논리 회로
전자공학에서 불 대수를 물리적 장치에 구현한 것
하나 이상의 논리적 입력값에 대한 논리 연사나을 수행하여 하나의 논리적 출력값을 얻는 전자 회로이다.

전자 회로
개별적인 부품들로 구성된 전기 회로이다.

전기 회로
전기가 흐를 수 있도록 설치된 닫힌 회로이다.
~~~

> AND, OR, NAND 게이트 모두 동일한 퍼셉트론의 구조를 사용한다. 

### 2.2.1 AND 게이트

* 입력은 둘이고 출력은 하나이다.
* 진리표를 만족하는 가중치(w1, w2)와 세타 값을 정한다 -> 매개변수의 값은 무수히 많다.
* 입력값 두개가 모두 1일때만 출력값 1을 갖는다.

AND 게이터의 진리표
|x1|x2|y|
|--|--|--|
|0|0|0|
|1|0|0|
|0|1|0|
|1|1|1|

### 2.2.2 NAND 게이트와 OR 게이트

### NAND 게이트

* Not AND -> AND 결과값의 반대의 출력값을 갖는다.
* 입력값 두개가 모두 1일때만 0을 출력한다.
* AND 매개변수의 부호를 모두 바꾸면 된다.

NAND 게이터의 진리표
|x1|x2|y|
|--|--|--|
|0|0|1|
|1|0|1|
|0|1|1|
|1|1|0|

### OR 게이트

* 모두 0일때만 0을 출력값으로 가진다.

OR 게이터의 진리표
|x1|x2|y|
|--|--|--|
|0|0|0|
|1|0|1|
|0|1|1|
|1|1|1|

## 2.3 퍼셉트론 구현하기

### 2.3.1 AND 게이트 구현

~~~
def AND(x1, x2):
    w1, w2, theta = 0.5, 0.5, 0.7
    tmp = x1*w1 + x2*w2
    if tmp <= theta:
        return 0
    elif tmp > theta:
        return 1

AND(0,0)
AND(1,0)
AND(0,1)
AND(1,1)
~~~

### 2.3.2 가중치와 편향 도입

* 기존 퍼셉트론의 수식을 변형한다.
* 세타 = b 로 치환후 양변에 b를 빼준다.

~~~
y={
 0 (b + w1x1 + w2x2 <= 0)
 1 (b + w1x1 + w2x2 > 0)
}
~~~

* 기존의 수식과 기호만 바뀌었으며 의미는 같다. -> 단 관점이 달라졌다.
* b는 편향이며 w1, w2는 그대로 가중치이다. -> 임계점이 없어지고 편향이 생겼다!
* 입력신호에 가중치를 곱한 값과 편향을 합하여 값이 0을 넘으면 1, 그렇지 않으면 0을 출력한다.
* 가중치(w1, w2)-> 각 입력 신호가 결과에 주는 영향력(중요도)
* 편향 -> 뉴런이 얼마나 __쉽게__ 활성화(결과로 1 출력)하느냐를 조정한다. 

~~~
import numpy as np
x= np.array([0,1])
y=np.array([0.5,0.5])
b = -0.7

w*x  #넘파이 배열은 원소 수가 같다면 각 원소끼리 곱한다.

np.sum(w*x)+b  #0.5*0 + 0.5*1 -0.7 = -0.1999... 
~~~

### 2.3.3 가중치와 편향 구현하기

~~~
# AND 게이트
def AND(x1, x2):
    x = np.array([x1, x2])
    y = np.array([0.5, 0.5])
    b = -0.7
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1

# NAND 게이트
def NAND(x1, x2):
    x = np.array([x1, x2])
    y = np.array([-0.5, -0.5])
    b = 0.7
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1

# OR 게이트
def OR(x1, x2):
    x = np.array([x1, x2])
    y = np.array([0.5, 0.5])
    b = -0.2
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1

~~~

## 2.4 퍼셉트론의 한계

퍼셉트론은 직선 하나로 나눈 두 개의 영역에 대해서만 표현이 가능하다. 따라서 곡선을 표현이 불가능하다.
AND, OR, NAND 같은 경우 하나의 직선을 기준으로 두 영역으로 나뉘는 모양을 띄기 때문에 퍼셉트론으로 구현가능하였다.
하지만 XOR 같은 경우 곡선 형태를 띄기 때문에 퍼셉트론으로는 구현이 불가능하다. 

### 퍼셉트론의 수식

퍼셉트론 수식은 다음과 같이 두가지 종류가 존재한다.
* 편향이 도입되지 않은 수식
* 편향이 도입된 수식

편향이 도입된 수식을 통해 퍼셉트론 수식은 기하학 적으로는 직선 모양을 띄는 것을 알 수 있다.

### 2.4.1 도전! XOR 게이트

* XOR 게이트는 배타적 논리합이라는 논리 회로이다. 
* 두 입력 신호중 한쪽이 1일 때만 1을 출력한다.

XOR 게이터의 진리표
|x1|x2|y|
|--|--|--|
|0|0|0|
|1|0|1|
|0|1|1|
|1|1|0|

### 2.4.2 선형과 비선형

AND, OR, NAND 게이트와 같이 직선 하나로 두개의 영역을 나뉘는 형상을 보이면 선형성을 띈다고 할 수 있다.
반면 XOR 게이트와 같이 곡선의 형상을 보이면 비선형성을 띈다고 할 수 있다.
기계 학습 분야에서는 선형성과 비선형성을 구분하여 그에맞는 적합한 구현하여 그에 방법을 세워야 한다.

## 2.5 다층 퍼셉트론이 충돌한다면 

다층 퍼셉트론은 단층 퍼셉트론을 이용해 층을 쌓은 형태이다. 이때 단층 퍼셉트론의 층은 1층이며 
다층 퍼셉트론의 층은 2층 이상이다.

### 2.5.1 기존 게이트 조합하기

단층 퍼셉트론을 이용해 2개의 층을 쌓은 다층 퍼셉트론으로 XOR 게이트를 구현할 수 있다.

XOR 게이터의 진리표
|x1|x2|s1|s2|y|
|--|--|--|--|--|
|0|0|1|0|0|
|1|0|1|1|1|
|0|1|1|1|1|
|1|1|0|1|0|

### 2.5.2 XOR 게이트 구현하기

~~~
def XOR(x1, x2):
    s1 = NAND(x1, x2)
    s2 = OR(x1, x2)
    y = AND(s1, s2)
    return y
~~~

AND, OR, NAND 게이트는 단층 퍼셉트론이며 XOR 게이트는 2층 퍼셉트론 형태이다.

![dls_2_13](https://github.com/jsw166098/deep-learning-scratch/blob/main/img/dls_2_13.png)

엄밀히 말하면 3층 퍼셉트론이지만 실제로 가중치가 부여된 층은 2개 이므로 2층 퍼셉트론으로 보기도 한다.

## 2.6 NAND에서 컴퓨터까지

NAND 게이트 만을 이용하여 컴퓨터를 표현할 수 있다. 이때 필요한 최소 층은 2이다. 즉 2층의 퍼셉트론과 NAND 게이터를 이용하면 컴퓨터를 만들수 있다.
하지만 NAND 게이트 만을 이용하여 표현하기에는 여럽기 때문에 저수준 소자에서 시작하여 단계적으로 자연스러운 방법으로 컴퓨터를 만드는 것이 일반적이다.
